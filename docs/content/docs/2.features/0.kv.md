---
title: Key Value Storage
navigation.title: Key Value
description: Use a key-value data storage in Nuxt.
---

NuxtHub Key Value Storage automatically configures [Nitro Storage](https://nitro.build/guide/storage), which is built on [unstorage](https://unstorage.unjs.io/).

## Getting Started

Enable the key-value storage in your NuxtHub project by adding the `kv` property to the `hub` object in your `nuxt.config.ts` file.

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  hub: {
    kv: true
  }
})
```

### Automatic Configuration

When building the Nuxt app, NuxtHub automatically configures the key-value storage driver on many providers.

::tabs{sync="provider"}
  :::tabs-item{label="Vercel" icon="i-simple-icons-vercel"}

    When deploying to Vercel, it automatically configures [Redis](https://redis.io/).

    1. Install the `ioredis` package

    :pm-install{name="ioredis"}

    2. Add a Redis database to your project from the [Vercel dashboard](https://vercel.com/) -> Project -> Storage

    ::callout
    In development, you can use the `REDIS_URL` environment variable to configure the Redis connection.
    ```bash [.env]
    REDIS_URL=redis://localhost:6379
    ```
    ::
  :::

  :::tabs-item{label="Cloudflare" icon="i-simple-icons-cloudflare"}

    When deploying to Cloudflare, it automatically configures [Cloudflare Workers KV](https://developers.cloudflare.com/kv/).

    Add a `KV` binding to a [Cloudflare Workers KV](https://developers.cloudflare.com/kv/) namespace in your `wrangler.jsonc` config.

    ```jsonc [wrangler.jsonc]
    {
      "$schema": "node_modules/wrangler/config-schema.json",
      // ...
      "kv_namespaces": [
        {
          "binding": "KV",
          "id": "<id>"
        }
      ]
    }
    ```

    Learn more about adding bindings on [Cloudflare's documentation](https://developers.cloudflare.com/kv/concepts/kv-bindings/#access-kv-from-workers).

  :::

  :::tabs-item{label="Deno" icon="i-simple-icons-deno"}

    When deploying to Deno Deploy, it automatically configures [Deno KV](https://deno.com/kv).

  :::

  :::tabs-item{label="Other" icon="i-simple-icons-nodedotjs"}

    When deploying to other providers, Nitro Storage `kv` is configured to use the [filesystem](https://unstorage.unjs.io/drivers/fs#nodejs-filesystem-lite).

    ::tip{to="#manual-configuration"}
      You can manually configure the `kv` mount to use a different storage driver.
    ::

  :::
::

::important
If no automatic configuration is found, it will default to [filesystem](https://unstorage.unjs.io/drivers/fs#nodejs-filesystem-lite) and store the data in the `.data/kv`.
::

### Manual Configuration

You can use any [unstorage](https://unstorage.unjs.io/drivers) driver by configuring the `hub.kv` option with a driver and its options.

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  hub: {
    kv: {
      driver: 'redis',
      url: 'redis://localhost:6379',
      /* any additional driver options */
    }
  }
})
```

::callout{to="https://unstorage.unjs.io/drivers"}
You can find the driver list on [unstorage documentation](https://unstorage.unjs.io/drivers) with their configuration.
::

## Usage

The `hub:kv` module provides access to the Key-Value storage through an [unstorage](https://unstorage.unjs.io) instance.

```ts
import { kv } from 'hub:kv'
```

::tip
`kv` is auto-imported on server-side, you can directly use it without importing it from `hub:kv`.
::

### Set an item

Puts an item in the storage.

```ts
import { kv } from 'hub:kv'

await kv.set('vue', { year: 2014 })

// using prefixes to organize your KV namespace, useful for the `keys` operation
await kv.set('vue:nuxt', { year: 2016 })
```

::note
The maximum size of a value is 25 MiB and the maximum length of a key is 512 bytes.
::

#### Expiration

By default, items in your KV namespace will never expire. You can delete them manually using the [`del()`](#delete-an-item) method or set a TTL (time to live) in seconds.

The item will be deleted after the TTL has expired. The `ttl` option maps to Cloudflare's [`expirationTtl`](https://developers.cloudflare.com/kv/api/write-key-value-pairs/#reference) option. Values that have recently been read will continue to return the cached value for up to 60 seconds and may not be immediately deleted for all regions.

```ts
import { kv } from 'hub:kv'

await kv.set('vue:nuxt', { year: 2016 }, { ttl: 60 })
```

<!--
### Metadata

You can also set metadata on the item.

```ts
await kv.set('vue', { year: 2024 }, {
  metadata: {
    author: 'Evan You'
  }
})
```
-->


### Get an item

Retrieves an item from the Key-Value storage.

```ts
import { kv } from 'hub:kv'

const vue = await kv.get('vue')
/*
{
  year: 2014
}
*/
```


### Has an item

Checks if an item exists in the storage.

```ts
import { kv } from 'hub:kv'

const hasAngular = await kv.has('angular') // false
const hasVue = await kv.has('vue') // true
```

### Delete an item

Delete an item with the given key from the storage.

```ts
import { kv } from 'hub:kv'

await kv.del('react')
```

### Clear the KV namespace

Deletes all items from the KV namespace..

```ts
import { kv } from 'hub:kv'

await kv.clear()
```

To delete all items for a specific prefix, you can pass the prefix as an argument. We recommend using prefixes for better organization in your KV namespace.

```ts
import { kv } from 'hub:kv'

await kv.clear('react')
```

### List all keys

Retrieves all keys from the KV storage.

```ts
import { kv } from 'hub:kv'

const keys = await kv.keys()
/*
[
  'react',
  'react:gatsby',
  'react:next',
  'vue',
  'vue:nuxt',
  'vue:quasar'
]
```

To get the keys starting with a specific prefix, you can pass the prefix as an argument. We recommend using prefixes for better organization in your KV namespace.

```ts
import { kv } from 'hub:kv'

const vueKeys = await kv.keys('vue')
/*
[
  'vue:nuxt',
  'vue:quasar'
]
*/
```
